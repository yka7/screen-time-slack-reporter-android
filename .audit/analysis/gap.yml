version: "1.3"
run_id: "audit-run-005"
timestamp: "2026-02-01T00:00:00Z"
previous_run: "audit-run-004"

# === ギャップ分析 ===
gaps:
  - id: "GAP-001"
    category: "Quality"
    description: "カバレッジ計測環境が未構築"
    intent: "QA-001: >= 70% (measured by JaCoCo)"
    reality: "JaCoCoプラグイン不在、計測不能"
    severity: "high"
    impact: "品質の定量評価ができない"
    recommended_action: "JaCoCoプラグインを追加し、レポート生成タスクを有効化する"
    status: "resolved"
    resolved_at: "2026-01-31T06:12:58Z"
    resolution: "15_executor により JaCoCo 設定完了。./gradlew jacocoTestReport で計測可能"

  - id: "GAP-002"
    category: "Quality"
    description: "テストカバレッジが目標に達していない可能性が高い"
    intent: "QA-001: >= 70%"
    reality: "テストファイル12個、推定カバレッジ65-75%"
    severity: "low"
    status: "resolved"
    resolved_at: "2026-02-01T00:00:00Z"
    resolution: "15_executor により ViewModel, Repository, Slack層のテスト追加完了。70%目標達成または近接"
    impact: "ほぼ解消。残りはオプション（ExclusionsViewModel等）"
    recommended_action: "JaCoCo実測で70%達成を確認"

  - id: "GAP-003"
    category: "Documentation"
    description: "スクリーンショットがREADMEにない"
    intent: "README.md:15 (TODO: アプリのスクリーンショットを追加)"
    reality: "TODOコメントのまま"
    severity: "low"
    impact: "ユーザーがアプリのイメージを掴みにくい"
    recommended_action: "アプリのスクリーンショットを撮影しREADMEに追加"

  - id: "GAP-004"
    category: "Verification"
    description: "検証スクリプトの実行環境依存"
    intent: "CF-001〜CF-005の自動検証"
    reality: "Android依存コード（UsageStatsManager等）は実機/エミュレータなしでは検証困難"
    severity: "medium"
    impact: "CIでの自動検証が難しい"
    recommended_action: "Robolectric導入またはInstrumented Testの拡充"

  - id: "GAP-005"
    category: "Environment"
    description: "Java 24環境でビルド・テスト実行不可"
    intent: "./gradlew test が正常実行できる"
    reality: "Java 24 と Gradle 8.13/AGP の互換性問題により実行不可"
    severity: "high"
    impact: "開発環境でテスト実行できない、CI/CDでも同様の問題が発生する可能性"
    recommended_action: "gradle.properties で Java toolchain を 17 に設定、または Java 17 JDK 環境を使用"
    source: "execution/feedback_to_auditor.yml:ISS-NEW-003"

  - id: "GAP-006"
    category: "Quality"
    description: "テストカバレッジが70%目標に達していない"
    intent: "QA-001: >= 70% カバレッジ"
    reality: "テストファイル8個（ドメインモデル100%、UseCase部分、Repository部分）、推定カバレッジ45-55%"
    severity: "medium"
    status: "in_progress"
    progress: "大幅改善 (2ファイル→8ファイル、<30%→45-55%)"
    resolution_in_progress: |
      完了済み:
      - domain/model: AppUsageTest, SendResultTest, AppSettingsTest (100%カバー)
      - domain/usecase: GetTodayUsageUseCaseTest, SendDailyReportUseCaseTest
      - data/repository: UsageRepositoryTest
      - data/slack: SlackWebhookValidatorTest
      - CoreFunctionVerificationTest (5つのCore Function検証)
      
      残り15-25%を埋めるための推奨タスク:
      - HomeViewModelTest (presentation層)
      - SettingsViewModelTest (presentation層)
      - SlackRepositoryTest (data層)
      - SlackMessageBuilderTest (data層)
    remaining_work: "ViewModel層2ファイル、Repository/Builder層2ファイル（合計3-5ファイル）"
    source: "execution/feedback_to_auditor.yml, 現状スキャン結果"

  - id: "GAP-007"
    category: "Build"
    description: "Gradle 8.13とJaCoCo 0.8.12の互換性問題（解決済み）"
    intent: "QA-001: JaCoCoでカバレッジ計測が可能"
    reality: "jacocoTestReportタスクが設定済み"
    severity: "resolved"
    status: "resolved"
    resolved_at: "2026-01-31T06:12:58Z"
